@{
    ViewData["Title"] = "我們的回憶";
}

<!-- Converted from Pages/Memories/Index.cshtml -->

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <style>
        /* ... keep original styles (omitted here for brevity) ... */
    </style>
</head>
<body>
    <a asp-controller="Home" asp-action="Index" class="back-btn" title="回到首頁">
        <!-- icon -->
    </a>

    <a asp-action="Create" class="add-memory-btn" title="新增回憶">
        <!-- icon -->
    </a>

    <div class="header">
        <h1>@ViewData["Title"]</h1>
        <div class="filter-container" id="filterContainer"></div>
    </div>

    <div class="gallery-container">
        <div class="loading">載入中...</div>
        <div class="gallery-grid" id="galleryGrid" style="display: none;"></div>
        <div class="empty-state" id="emptyState" style="display: none;">
            還沒有任何回憶<br>
            <a asp-action="Create" class="text-white text-decoration-underline">開始建立第一個回憶</a>
        </div>
    </div>

    <div class="modal" id="photoModal">
        <button class="modal-btn modal-close" id="modalClose">X</button>
        <div class="modal-content">
            <div class="modal-image-container">
                <img class="modal-image" id="modalImage" src="" alt="">
            </div>
            <div class="modal-info">
                <div class="modal-date"><span id="modalDate"></span></div>
                <h2 class="modal-title" id="modalTitle"></h2>
                <div class="modal-tags" id="modalTags"><span class="modal-tag">家庭</span></div>
                <p class="modal-description" id="modalDescription"></p>
                <div class="modal-footer">
                    <div class="modal-actions">
                        <a asp-action="Edit" asp-route-id="" id="editLink" class="text-white text-decoration-none me-3">編輯</a>
                        <a asp-action="Delete" asp-route-id="" id="deleteLink" class="text-danger text-decoration-none">刪除</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // keep original script but replace asp-page link handling with MVC routes
        async function loadMemories() {
            try {
                const response = await fetch('/api/memories', { credentials: 'same-origin' });
                if (response.ok) {
                    const allMemories = await response.json();
                    // render gallery (omitted for brevity)
                }
            } catch (e) { console.error(e); }
        }

        function openModal(memoryId, title, description, imagePath, date) {
            document.getElementById('editLink').href = '/Memories/Edit?id=' + memoryId;
            document.getElementById('deleteLink').href = '/Memories/Delete?id=' + memoryId;
            document.getElementById('photoModal').classList.add('active');
        }

        document.addEventListener('DOMContentLoaded', function() { loadMemories(); });
    </script>
</body>
</html>
